<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <!-- Directory for Purchase Contract XLSX Reports -->
        <record model="document.directory" id="dir_purchase_contract_reports">
            <field name="name">Purchase Contract Reports</field>
            <field name="parent_id" ref="document.dir_root"/>
            <field name="user_id" ref="base.user_root"/>
            <field name="ressource_id">0</field>
            <field name="group_ids" eval="[(4, ref('base.group_user'))]" />
        </record>

        # Purchase Contract
        <record id="xlsx_report_purchase_contract" model="ir.attachment">
            <field name="res_model">xlsx.report.purchase.contract</field>
            <field name="datas"></field>
            <field name="datas_fname">xlsx_report_purchase_contract.xlsx</field>
            <field name="name">Purchase Contract</field>
            <field name="parent_id" eval="ref('dir_purchase_contract_reports')"/>
            <field name="description">
              {
                '__EXPORT__': {
                    'Purchase Contract Report': {
                        '_HEAD_': {
                            'A1': '${env["res.company"].browse(env["res.company"]._company_default_get("xlsx.report.purchase.contract")).display_name}',
                            'B3': 'date_report${value or ""}#{number_format=date;align=left}',
                            'B4': '${env.user.display_name}',
                            'B5': '${time.strftime("%d/%m/%Y")}#{number_format=date;align=left}',
                        },
                        'results': {
                            'A8': 'operating_unit_id${value and (value.org_id and value.org_id.name_short or "") or ""}',
                            'B8': 'supplier_id.search_key${value or ""}',
                            'C8': 'supplier_id.name${value or ""}',
                            'D8': 'name${value or ""}',
                            'E8': 'requisition_id.purchase_ids${value and (value.filtered(lambda l: l.state == "done") and value.filtered(lambda l: l.state == "done")[0].name or "") or ""}',
                            'F8': 'display_code${value or ""}',
                            'G8': 'start_date${value or ""}#{number_format=date}',
                            'H8': 'end_date${value or ""}#{number_format=date}',
                            'I8': 'collateral_type_id.name${value or ""}',
                            'J8': 'collateral_no${value or ""}',
                            'K8': 'collateral_date${value or ""}#{number_format=date}',
                            'L8': 'bank${value or ""}',
                            'M8': 'branch${value or ""}',
                            'N8': 'currency_id.name${value or ""}',
                            'O8': 'contract_amt${value or ""}#{number_format=number}',
                            'P8': 'collateral_agreement_amt${value or ""}#{number_format=number}',
                            'Q8': 'collateral_due_date${value or ""}#{number_format=date}',
                        },
                        '_TAIL_0': {
                            'P8': '@{sum}#{font=bold;number_format=number}',
                            'S8': '@{sum}#{font=bold;number_format=number}',
                            'T8': '@{sum}#{font=bold;number_format=number}',
                            'U8': '@{sum}#{font=bold;number_format=number}',
                            'V8': '@{sum}#{font=bold;number_format=number}',
                            'W8': '@{sum}#{font=bold;number_format=number}',
                            'X8': '@{sum}#{font=bold;number_format=number}',
                            'Y8': '@{sum}#{font=bold;number_format=number}',
                            'Z8': '@{sum}#{font=bold;number_format=number}',
                        }
                    }
                }
            }
          </field>
        </record>
    </data>
</openerp>
