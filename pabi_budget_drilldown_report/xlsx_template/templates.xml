<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
        # Budget Overview Report
        <!-- Directory Budget Overview Report -->
        <record model="document.directory" id="dir_budget_drilldown_template">
            <field name="name">Budget Drilldown Templates</field>
            <field name="parent_id" ref="document.dir_root"/>
            <field name="user_id" ref="base.user_root"/>
            <field name="ressource_id">0</field>
            <field name="group_ids" eval="[(4, ref('base.group_user'))]" />
        </record>

        # Budget Overall Report
        <record id="budget_overall_report_xlsx_template" model="ir.attachment">
            <field name="res_model">budget.drilldown.report</field>
            <field name="datas"></field>
            <field name="datas_fname">budget_overall_report.xlsx</field>
            <field name="name">Budget Overall Report</field>
            <field name="parent_id" eval="ref('dir_budget_drilldown_template')"/>
            <field name="description">
              {
                '__EXPORT__': {
                    'Budget Overall Report': {
                        '_HEAD_': {
                            'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                            'B3': 'report_type${value and dict(overall="Overall", unit_base="Section", project_base="Project", invest_asset="Asset", invest_construction="Construction", personnel="Personnel")[value] or ""}',
                            'B4': 'fiscalyear_id${value and value.name or ""}',
                            'B5': 'org_id${value and value.name_short or ""}',
                            'B6': 'budget_method${value and dict(revenue="Revenue", expense="Expense")[value] or ""}',
                            'B7': '${env.user.with_context(lang="th_TH").display_name}',
                            'B8': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                        },
                        'line_external_ids': {
                            'A11': 'chart_view${value and dict(env["budget.drilldown.report.line"]._columns["chart_view"].selection)[value] or ""}',
                            'B11': 'charge_type${value and dict(env["budget.drilldown.report.line"]._columns["charge_type"].selection)[value] or "All"}',
                            'C11': 'released_amount${value or 0}#{number_format=number}',
                            'D11': 'amount_pr_commit${value or 0}#{number_format=number}',
                            'E11': 'amount_po_commit${value or 0}#{number_format=number}',
                            'F11': 'amount_exp_commit${value or 0}#{number_format=number}',
                            'G11': 'amount_total_commit${value or 0}#{number_format=number}',
                            'H11': 'amount_actual${value or 0}#{number_format=number}',
                            'I11': 'amount_consumed${value or 0}#{number_format=number}',
                            'J11': 'amount_balance${value or 0}#{number_format=number}',
                            'K11': "${'=IF(OR(?(C11)=0,?(G11)=0),0,?(G11)/?(C11))'}#{number_format=percent}",
                            'L11': "${'=IF(OR(?(C11)=0,?(H11)=0),0,?(H11)/?(C11))'}#{number_format=percent}",
                            'M11': "${'=IF(OR(?(C11)=0,?(I11)=0),0,?(I11)/?(C11))'}#{number_format=percent}",
                        },
                        'line_internal_ids': {
                            'A19': 'chart_view${value and dict(env["budget.drilldown.report.line"]._columns["chart_view"].selection)[value] or ""}',
                            'B19': 'charge_type${value and dict(env["budget.drilldown.report.line"]._columns["charge_type"].selection)[value] or "All"}',
                            'C19': 'released_amount${value or 0}#{number_format=number}',
                            'D19': 'amount_pr_commit${value or 0}#{number_format=number}',
                            'E19': 'amount_po_commit${value or 0}#{number_format=number}',
                            'F19': 'amount_exp_commit${value or 0}#{number_format=number}',
                            'G19': 'amount_total_commit${value or 0}#{number_format=number}',
                            'H19': 'amount_actual${value or 0}#{number_format=number}',
                            'I19': 'amount_consumed${value or 0}#{number_format=number}',
                            'J19': 'amount_balance${value or 0}#{number_format=number}',
                            'K19': "${'=IF(OR(?(C19)=0,?(G19)=0),0,?(G19)/?(C19))'}#{number_format=percent}",
                            'L19': "${'=IF(OR(?(C19)=0,?(H19)=0),0,?(H19)/?(C19))'}#{number_format=percent}",
                            'M19': "${'=IF(OR(?(C19)=0,?(I19)=0),0,?(I19)/?(C19))'}#{number_format=percent}",
                        },
                        'line_all_ids': {
                            'A27': 'chart_view${value and dict(env["budget.drilldown.report.line"]._columns["chart_view"].selection)[value] or ""}',
                            'B27': 'charge_type${value and dict(env["budget.drilldown.report.line"]._columns["charge_type"].selection)[value] or "All"}',
                            'C27': 'released_amount${value or 0}#{number_format=number}',
                            'D27': 'amount_pr_commit${value or 0}#{number_format=number}',
                            'E27': 'amount_po_commit${value or 0}#{number_format=number}',
                            'F27': 'amount_exp_commit${value or 0}#{number_format=number}',
                            'G27': 'amount_total_commit${value or 0}#{number_format=number}',
                            'H27': 'amount_actual${value or 0}#{number_format=number}',
                            'I27': 'amount_consumed${value or 0}#{number_format=number}',
                            'J27': 'amount_balance${value or 0}#{number_format=number}',
                            'K27': "${'=IF(OR(?(C27)=0,?(G27)=0),0,?(G27)/?(C27))'}#{number_format=percent}",
                            'L27': "${'=IF(OR(?(C27)=0,?(H27)=0),0,?(H27)/?(C27))'}#{number_format=percent}",
                            'M27': "${'=IF(OR(?(C27)=0,?(I27)=0),0,?(I27)/?(C27))'}#{number_format=percent}",
                        },
                        '_TAIL_0': {
                            'C11': '@{sum}#{font=bold;align=right;number_format=number}',
                            'D11': '@{sum}#{font=bold;align=right;number_format=number}',
                            'E11': '@{sum}#{font=bold;align=right;number_format=number}',
                            'F11': '@{sum}#{font=bold;align=right;number_format=number}',
                            'G11': '@{sum}#{font=bold;align=right;number_format=number}',
                            'H11': '@{sum}#{font=bold;align=right;number_format=number}',
                            'I11': '@{sum}#{font=bold;align=right;number_format=number}',
                            'J11': '@{sum}#{font=bold;align=right;number_format=number}',
                            'C19': '@{sum}#{font=bold;align=right;number_format=number}',
                            'D19': '@{sum}#{font=bold;align=right;number_format=number}',
                            'E19': '@{sum}#{font=bold;align=right;number_format=number}',
                            'F19': '@{sum}#{font=bold;align=right;number_format=number}',
                            'G19': '@{sum}#{font=bold;align=right;number_format=number}',
                            'H19': '@{sum}#{font=bold;align=right;number_format=number}',
                            'I19': '@{sum}#{font=bold;align=right;number_format=number}',
                            'J19': '@{sum}#{font=bold;align=right;number_format=number}',
                            'C27': '@{sum}#{font=bold;align=right;number_format=number}',
                            'D27': '@{sum}#{font=bold;align=right;number_format=number}',
                            'E27': '@{sum}#{font=bold;align=right;number_format=number}',
                            'F27': '@{sum}#{font=bold;align=right;number_format=number}',
                            'G27': '@{sum}#{font=bold;align=right;number_format=number}',
                            'H27': '@{sum}#{font=bold;align=right;number_format=number}',
                            'I27': '@{sum}#{font=bold;align=right;number_format=number}',
                            'J27': '@{sum}#{font=bold;align=right;number_format=number}',
                        }
                    }
                }
              }
          </field>
        </record>

        # Budget All Report
        <record id="budget_all_report_xlsx_template" model="ir.attachment">
            <field name="res_model">budget.drilldown.report</field>
            <field name="datas"></field>
            <field name="datas_fname">budget_all_report.xlsx</field>
            <field name="name">Budget All Report</field>
            <field name="parent_id" eval="ref('dir_budget_drilldown_template')"/>
            <field name="description">
              {
                '__EXPORT__': {
                    'Budget All Report': {
                        '_HEAD_': {
                            'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                            'B3': 'report_type${value and dict(overall="Overall", all="All Budget", unit_base="Section", project_base="Project", invest_asset="Asset", invest_construction="Construction", personnel="Personnel")[value] or ""}',
                            'B4': 'fiscalyear_id${value and value.name or ""}',
                            'B5': 'chartfield_ids${value and ", ".join([x.code for x in value]) or ""}',
                            'B6': 'charge_type${value and dict(internal="Internal", external="External")[value] or ""}',
                            'B7': 'org_id${value and value.name_short or ""}',
                            'B8': 'sector_id${value and value.name_short or ""}',
                            'B9': 'subsector_id${value and value.name_short or ""}',
                            'B10': 'division_id${value and value.name_short or ""}',
                            'B11': 'section_id${value and value.name_short or ""}',
                            'B12': 'section_program_id${value and value.name_short or ""}',
                            'B13': 'budget_method${value and dict(revenue="Revenue", expense="Expense")[value] or ""}',
                            'B14': '${env.user.with_context(lang="th_TH").display_name}',
                            'B15': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                        },
                        'line_ids': {
                            'A18': 'chartfield_id${value and value.code or ""}',
                            'B18': 'chartfield_id${value and value.name or ""}',
                            'C18': 'activity_group_id${value and value.name or ""}',
                            'D18': 'charge_type${value and dict(env["budget.drilldown.report.line"]._columns["charge_type"].selection)[value] or ""}',
                            'E18': 'activity_id${value and value.name or ""}',
                            'F18': 'planned_amount${value or 0}#{number_format=number}',
                            'G18': 'released_amount${value or 0}#{number_format=number}',
                            'H18': 'amount_pr_commit${value or 0}#{number_format=number}',
                            'I18': 'amount_po_commit${value or 0}#{number_format=number}',
                            'J18': 'amount_exp_commit${value or 0}#{number_format=number}',
                            'K18': 'amount_total_commit${value or 0}#{number_format=number}',
                            'L18': 'amount_actual${value or 0}#{number_format=number}',
                            'M18': 'amount_consumed${value or 0}#{number_format=number}',
                            'N18': 'amount_balance${value or 0}#{number_format=number}',
                            'O18': "${'=IF(OR(?(G18)=0,?(K18)=0),0,?(K18)/?(G18))'}#{number_format=percent}",
                            'P18': "${'=IF(OR(?(G18)=0,?(L18)=0),0,?(L18)/?(G18))'}#{number_format=percent}",
                            'Q18': "${'=IF(OR(?(G18)=0,?(M18)=0),0,?(M18)/?(G18))'}#{number_format=percent}",
                        },
                        '_TAIL_0': {
                            'F18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'G18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'H18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'I18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'J18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'K18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'L18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'M18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'N18': '@{sum}#{font=bold;align=right;number_format=number}',
                        }
                    }
                }
              }
          </field>
        </record>

        # Budget Unit Base Report
        <record id="budget_unit_base_report_xlsx_template" model="ir.attachment">
            <field name="res_model">budget.drilldown.report</field>
            <field name="datas"></field>
            <field name="datas_fname">budget_unit_base_report.xlsx</field>
            <field name="name">Budget Section Report</field>
            <field name="parent_id" eval="ref('dir_budget_drilldown_template')"/>
            <field name="description">
              {
                '__EXPORT__': {
                    'Budget Section Report': {
                        '_HEAD_': {
                            'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                            'B3': 'report_type${value and dict(overall="Overall", unit_base="Section", project_base="Project", invest_asset="Asset", invest_construction="Construction", personnel="Personnel")[value] or ""}',
                            'B4': 'fiscalyear_id${value and value.name or ""}',
                            'B5': 'charge_type${value and dict(env["budget.drilldown.report.line"]._columns["charge_type"].selection)[value] or ""}',
                            'B6': 'org_id${value and value.name_short or ""}',
                            'B7': 'sector_id${value and value.name or ""}',
                            'B8': 'subsector_id${value and value.name or ""}',
                            'B9': 'division_id${value and value.name or ""}',
                            'B10': 'section_id${value and value.name or ""}',
                            'B11': 'budget_method${value and dict(revenue="Revenue", expense="Expense")[value] or ""}',
                            'B12': 'activity_group_id${value and value.name or ""}',
                            'B13': 'activity_id${value and value.name or ""}',
                            'B14': 'group_by_section_id${value and "True" or "False"}',
                            'B15': 'group_by_activity_group_id${value and "True" or "False"}',
                            'B16': 'group_by_charge_type${value and "True" or "False"}',
                            'B17': 'group_by_activity_id${value and "True" or "False"}',
                            'B18': '${env.user.with_context(lang="th_TH").display_name}',
                            'B19': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                        },
                        'line_ids': {
                            'A22': 'section_id${value and value.code or ""}',
                            'B22': 'section_id${value and value.name or ""}',
                            'C22': 'activity_group_id${value and value.name or ""}',
                            'D22': 'charge_type${value and dict(env["budget.drilldown.report.line"]._columns["charge_type"].selection)[value] or ""}',
                            'E22': 'activity_id${value and value.name or ""}',
                            'F22': 'planned_amount${value or 0}#{number_format=number}',
                            'G22': 'released_amount${value or 0}#{number_format=number}',
                            'H22': 'amount_pr_commit${value or 0}#{number_format=number}',
                            'I22': 'amount_po_commit${value or 0}#{number_format=number}',
                            'J22': 'amount_exp_commit${value or 0}#{number_format=number}',
                            'K22': 'amount_total_commit${value or 0}#{number_format=number}',
                            'L22': 'amount_actual${value or 0}#{number_format=number}',
                            'M22': 'amount_consumed${value or 0}#{number_format=number}',
                            'N22': 'amount_balance${value or 0}#{number_format=number}',
                            'O22': "${'=IF(OR(?(G22)=0,?(K22)=0),0,?(K22)/?(G22))'}#{number_format=percent}",
                            'P22': "${'=IF(OR(?(G22)=0,?(L22)=0),0,?(L22)/?(G22))'}#{number_format=percent}",
                            'Q22': "${'=IF(OR(?(G22)=0,?(M22)=0),0,?(M22)/?(G22))'}#{number_format=percent}",
                        },
                        '_TAIL_0': {
                            'F22': '@{sum}#{font=bold;align=right;number_format=number}',
                            'G22': '@{sum}#{font=bold;align=right;number_format=number}',
                            'H22': '@{sum}#{font=bold;align=right;number_format=number}',
                            'I22': '@{sum}#{font=bold;align=right;number_format=number}',
                            'J22': '@{sum}#{font=bold;align=right;number_format=number}',
                            'K22': '@{sum}#{font=bold;align=right;number_format=number}',
                            'L22': '@{sum}#{font=bold;align=right;number_format=number}',
                            'M22': '@{sum}#{font=bold;align=right;number_format=number}',
                            'N22': '@{sum}#{font=bold;align=right;number_format=number}',
                        }
                    }
                }
              }
          </field>
        </record>

        # Budget Project Base Report
        <record id="budget_project_base_report_xlsx_template" model="ir.attachment">
            <field name="res_model">budget.drilldown.report</field>
            <field name="datas"></field>
            <field name="datas_fname">budget_project_base_report.xlsx</field>
            <field name="name">Budget Project Report</field>
            <field name="parent_id" eval="ref('dir_budget_drilldown_template')"/>
            <field name="description">
              {
                '__EXPORT__': {
                    'Budget Project Report': {
                        '_HEAD_': {
                            'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                            'B3': 'report_type${value and dict(overall="Overall", unit_base="Section", project_base="Project", invest_asset="Asset", invest_construction="Construction", personnel="Personnel")[value] or ""}',
                            'B4': 'fiscalyear_id${value and value.name or ""}',
                            'B5': 'charge_type${value and dict(internal="Internal", external="External")[value] or ""}',
                            'B6': 'org_id${value and value.name_short or ""}',
                            'B7': 'sector_id${value and value.name_short or ""}',
                            'B8': 'subsector_id${value and value.name_short or ""}',
                            'B9': 'division_id${value and value.name_short or ""}',
                            'B10': 'section_id${value and value.name_short or ""}',
                            'B11': 'budget_method${value and dict(revenue="Revenue", expense="Expense")[value] or ""}',
                            'B12': 'functional_area_id${value and value.name or ""}',
                            'B13': 'program_group_id${value and value.name or ""}',
                            'B14': 'program_id${value and value.name or ""}',
                            'B15': 'project_group_id${value and value.name or ""}',
                            'B16': 'project_id${value and value.name or ""}',
                            'B17': '${env.user.with_context(lang="th_TH").display_name}',
                            'B18': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                        },
                        'line_ids': {
                            'A21': 'project_id${value and value.code or ""}',
                            'B21': 'project_id${value and value.name or ""}',
                            'C21': 'activity_group_id${value and value.name or ""}',
                            'D21': 'charge_type${value and dict(env["budget.drilldown.report.line"]._columns["charge_type"].selection)[value] or ""}',
                            'E21': 'activity_id${value and value.name or ""}',
                            'F21': 'planned_amount${value or 0}#{number_format=number}',
                            'G21': 'released_amount${value or 0}#{number_format=number}',
                            'H21': 'amount_pr_commit${value or 0}#{number_format=number}',
                            'I21': 'amount_po_commit${value or 0}#{number_format=number}',
                            'J21': 'amount_exp_commit${value or 0}#{number_format=number}',
                            'K21': 'amount_total_commit${value or 0}#{number_format=number}',
                            'L21': 'amount_actual${value or 0}#{number_format=number}',
                            'M21': 'amount_consumed${value or 0}#{number_format=number}',
                            'N21': 'amount_balance${value or 0}#{number_format=number}',
                            'O21': "${'=IF(OR(?(G21)=0,?(K21)=0),0,?(K21)/?(G21))'}#{number_format=percent}",
                            'P21': "${'=IF(OR(?(G21)=0,?(L21)=0),0,?(L21)/?(G21))'}#{number_format=percent}",
                            'Q21': "${'=IF(OR(?(G21)=0,?(M21)=0),0,?(M21)/?(G21))'}#{number_format=percent}",
                        },
                        '_TAIL_0': {
                            'F21': '@{sum}#{font=bold;align=right;number_format=number}',
                            'G21': '@{sum}#{font=bold;align=right;number_format=number}',
                            'H21': '@{sum}#{font=bold;align=right;number_format=number}',
                            'I21': '@{sum}#{font=bold;align=right;number_format=number}',
                            'J21': '@{sum}#{font=bold;align=right;number_format=number}',
                            'K21': '@{sum}#{font=bold;align=right;number_format=number}',
                            'L21': '@{sum}#{font=bold;align=right;number_format=number}',
                            'M21': '@{sum}#{font=bold;align=right;number_format=number}',
                            'N21': '@{sum}#{font=bold;align=right;number_format=number}',
                        }
                    }
                }
              }
          </field>
        </record>

        # Budget Invest Asset Report
        <record id="budget_invest_asset_report_xlsx_template" model="ir.attachment">
            <field name="res_model">budget.drilldown.report</field>
            <field name="datas"></field>
            <field name="datas_fname">budget_invest_asset_report.xlsx</field>
            <field name="name">Budget Asset Report</field>
            <field name="parent_id" eval="ref('dir_budget_drilldown_template')"/>
            <field name="description">
              {
                '__EXPORT__': {
                    'Budget Asset Report': {
                        '_HEAD_': {
                            'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                            'B3': 'report_type${value and dict(overall="Overall", unit_base="Section", project_base="Project", invest_asset="Asset", invest_construction="Construction", personnel="Personnel")[value] or ""}',
                            'B4': 'charge_type${value and dict(internal="Internal", external="External")[value] or ""}',
                            'B5': 'org_id${value and value.name_short or ""}',
                            'B6': 'sector_id${value and value.name_short or ""}',
                            'B7': 'subsector_id${value and value.name_short or ""}',
                            'B8': 'division_id${value and value.name_short or ""}',
                            'B9': 'section_id${value and value.name_short or ""}',
                            'B10': 'budget_method${value and dict(revenue="Revenue", expense="Expense")[value] or ""}',
                            'B11': 'invest_asset_id${value and value.name or ""}',
                            'B12': 'activity_group_id${value and value.name or ""}',
                            'B13': 'activity_id${value and value.name or ""}',
                            'B14': '${env.user.with_context(lang="th_TH").display_name}',
                            'B15': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                        },
                        'line_ids': {
                            'A18': 'org_id${value and value.name_short or ""}',
                            'B18': 'invest_asset_id${value and value.owner_division_id.code}',
                            'C18': 'invest_asset_id${value and value.owner_division_id.name}',
                            'D18': 'invest_asset_id${value and value.owner_section_id.code}',
                            'E18': 'invest_asset_id${value and value.owner_section_id.name}',
                            'F18': 'invest_asset_id${value and value.code or ""}',
                            'G18': 'invest_asset_id${value and value.name or ""}',
                            'H18': 'invest_asset_id${value and value.active is True and "True" or "False"}',
                            'I18': 'planned_amount${value or 0}#{number_format=number}',
                            'J18': 'released_amount${value or 0}#{number_format=number}',
                            'K18': 'amount_pr_commit${value or 0}#{number_format=number}',
                            'L18': 'amount_po_commit${value or 0}#{number_format=number}',
                            'M18': 'amount_exp_commit${value or 0}#{number_format=number}',
                            'N18': 'amount_total_commit${value or 0}#{number_format=number}',
                            'O18': 'amount_actual${value or 0}#{number_format=number}',
                            'P18': 'amount_consumed${value or 0}#{number_format=number}',
                            'Q18': 'amount_balance${value or 0}#{number_format=number}',
                            'R18': "${'=IF(OR(?(J18)=0,?(N18)=0),0,?(N18)/?(J18))'}#{number_format=percent}",
                            'S18': "${'=IF(OR(?(J18)=0,?(O18)=0),0,?(O18)/?(J18))'}#{number_format=percent}",
                            'T18': "${'=IF(OR(?(J18)=0,?(P18)=0),0,?(P18)/?(J18))'}#{number_format=percent}",
                        },
                        '_TAIL_0': {
                            'I18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'J18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'K18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'L18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'M18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'N18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'O18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'P18': '@{sum}#{font=bold;align=right;number_format=number}',
                            'Q18': '@{sum}#{font=bold;align=right;number_format=number}',
                        }
                    }
                }
              }
          </field>
        </record>

        # Budget Invest Construction Report
        <record id="budget_invest_construction_report_xlsx_template" model="ir.attachment">
            <field name="res_model">budget.drilldown.report</field>
            <field name="datas"></field>
            <field name="datas_fname">budget_invest_construction_report.xlsx</field>
            <field name="name">Budget Construction Report</field>
            <field name="parent_id" eval="ref('dir_budget_drilldown_template')"/>
            <field name="description">
              {
                '__EXPORT__': {
                    'Budget Construction Report': {
                        '_HEAD_': {
                            'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                            'B3': 'report_type${value and dict(overall="Overall", unit_base="Section", project_base="Project", invest_asset="Asset", invest_construction="Construction", personnel="Personnel")[value] or ""}',
                            'B4': 'charge_type${value and dict(internal="Internal", external="External")[value] or ""}',
                            'B5': 'org_id${value and value.name_short or ""}',
                            'B6': 'sector_id${value and value.name_short or ""}',
                            'B7': 'subsector_id${value and value.name_short or ""}',
                            'B8': 'division_id${value and value.name_short or ""}',
                            'B9': 'section_id${value and value.name_short or ""}',
                            'B10': 'budget_method${value and dict(revenue="Revenue", expense="Expense")[value] or ""}',
                            'B11': 'invest_construction_id${value and value.name or ""}',
                            'B12': '${env.user.with_context(lang="th_TH").display_name}',
                            'B13': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                        },
                        'line_ids': {
                            'A16': 'org_id${value and value.name_short or ""}',
                            'B16': '${"ดึงไม่ได้"}',
                            'C16': "${'ดึงไม่ได้'}",
                            'D16': '${"ดึงไม่ได้ "}',
                            'E16': 'invest_construction_id${value and value.code or ""}',
                            'F16': 'invest_construction_id${value and value.name or ""}',
                            'G16': 'invest_construction_phase_id${value and value.code or ""}',
                            'H16': 'invest_construction_phase_id${value and value.name or ""}',
                            'I16': "${'ดึงไม่ได้ '}",
                            'J16': 'planned_amount${value or 0}#{number_format=number}',
                            'K16': 'released_amount${value or 0}#{number_format=number}',
                            'L16': 'amount_pr_commit${value or 0}#{number_format=number}',
                            'M16': 'amount_po_commit${value or 0}#{number_format=number}',
                            'N16': 'amount_exp_commit${value or 0}#{number_format=number}',
                            'O16': 'amount_total_commit${value or 0}#{number_format=number}',
                            'P16': 'amount_actual${value or 0}#{number_format=number}',
                            'Q16': 'amount_consumed${value or 0}#{number_format=number}',
                            'R16': 'amount_balance${value or 0}#{number_format=number}',
                            'S16': "${'=IF(OR(?(K16)=0,?(O16)=0),0,?(O16)/?(K16))'}#{number_format=percent}",
                            'T16': "${'=IF(OR(?(K16)=0,?(P16)=0),0,?(P16)/?(K16))'}#{number_format=percent}",
                            'U16': "${'=IF(OR(?(K16)=0,?(Q16)=0),0,?(Q16)/?(K16))'}#{number_format=percent}",
                        },
                        '_TAIL_0': {
                            'J16': '@{sum}#{font=bold;align=right;number_format=number}',
                            'K16': '@{sum}#{font=bold;align=right;number_format=number}',
                            'L16': '@{sum}#{font=bold;align=right;number_format=number}',
                            'M16': '@{sum}#{font=bold;align=right;number_format=number}',
                            'N16': '@{sum}#{font=bold;align=right;number_format=number}',
                            'O16': '@{sum}#{font=bold;align=right;number_format=number}',
                            'P16': '@{sum}#{font=bold;align=right;number_format=number}',
                            'Q16': '@{sum}#{font=bold;align=right;number_format=number}',
                            'R16': '@{sum}#{font=bold;align=right;number_format=number}',
                        }
                    }
                }
              }
          </field>
        </record>

        # Budget Personnel Report
        <record id="budget_personnel_report_xlsx_template" model="ir.attachment">
            <field name="res_model">budget.drilldown.report</field>
            <field name="datas"></field>
            <field name="datas_fname">budget_personnel_report.xlsx</field>
            <field name="name">Budget Personnel Report</field>
            <field name="parent_id" eval="ref('dir_budget_drilldown_template')"/>
            <field name="description">
              {
                '__EXPORT__': {
                    'Budget Personnel Report': {
                        '_HEAD_': {
                            'A1': '${env.user.with_context(lang="en_US").company_id.partner_id.name}',
                            'B3': 'report_type${value and dict(overall="Overall", unit_base="Section", project_base="Project", invest_asset="Asset", invest_construction="Construction", personnel="Personnel")[value] or ""}',
                            'B4': 'fiscalyear_id${value and value.name or ""}',
                            'B5': 'org_id${value and value.name_short or ""}',
                            'B6': 'sector_id${value and value.name or ""}',
                            'B7': 'subsector_id${value and value.name or ""}',
                            'B8': 'division_id${value and value.name or ""}',
                            'B9': '${env.user.with_context(lang="th_TH").display_name}',
                            'B10': '${time.strftime("%d/%m/%Y")}#{number_format=date}',
                        },
                        'line_ids': {
                            'A13': 'org_id${value and value.name_short or ""}',
                            'B13': 'personnel_costcenter_id${value and value.code or ""}',
                            'C13': 'personnel_costcenter_id${value and value.name or ""}',
                            'D13': 'activity_group_id${value and value.name or ""}',
                            'E13': 'activity_id${value and value.name or ""}',
                            'F13': 'planned_amount${value or 0}#{number_format=number}',
                            'G13': 'released_amount${value or 0}#{number_format=number}',
                            'H13': 'amount_pr_commit${value or 0}#{number_format=number}',
                            'I13': 'amount_po_commit${value or 0}#{number_format=number}',
                            'J13': 'amount_exp_commit${value or 0}#{number_format=number}',
                            'K13': 'amount_total_commit${value or 0}#{number_format=number}',
                            'L13': 'amount_actual${value or 0}#{number_format=number}',
                            'M13': 'amount_consumed${value or 0}#{number_format=number}',
                            'N13': 'amount_balance${value or 0}#{number_format=number}',
                            'O13': "${'=IF(OR(?(G13)=0,?(K13)=0),0,?(K13)/?(G13))'}#{number_format=percent}",
                            'P13': "${'=IF(OR(?(G13)=0,?(L13)=0),0,?(L13)/?(G13))'}#{number_format=percent}",
                            'Q13': "${'=IF(OR(?(G13)=0,?(M13)=0),0,?(M13)/?(G13))'}#{number_format=percent}",
                        },
                        '_TAIL_0': {
                            'F13': '@{sum}#{font=bold;align=right;number_format=number}',
                            'G13': '@{sum}#{font=bold;align=right;number_format=number}',
                            'H13': '@{sum}#{font=bold;align=right;number_format=number}',
                            'I13': '@{sum}#{font=bold;align=right;number_format=number}',
                            'J13': '@{sum}#{font=bold;align=right;number_format=number}',
                            'K13': '@{sum}#{font=bold;align=right;number_format=number}',
                            'L13': '@{sum}#{font=bold;align=right;number_format=number}',
                            'M13': '@{sum}#{font=bold;align=right;number_format=number}',
                            'N13': '@{sum}#{font=bold;align=right;number_format=number}',
                        }
                    }
                }
              }
          </field>
        </record>
    </data>
</openerp>
